// src/app/dashboard/forum/create/page.tsx
'use client';

import React, { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { Menubar } from '@/components/layout';
import {
    Button,
    Card,
    Col,
    ConfigProvider,
    Form,
    Input,
    message,
    Row,
    Select,
    Space,
    Tag,
    Typography,
    Upload,
    Tooltip,
} from 'antd';
import {
    ArrowLeftOutlined,
    BoldOutlined,
    ItalicOutlined,
    LinkOutlined,
    OrderedListOutlined,
    PictureOutlined,
    UnorderedListOutlined,
    UploadOutlined,
    SendOutlined,
    SaveOutlined,
    EyeOutlined,
    EditOutlined,
    DeleteOutlined,
    ReloadOutlined,
    InfoCircleOutlined,
} from '@ant-design/icons';
import { PostsApi, CreatePostRequest } from '@/lib/api/posts';
import { AuthApi } from '@/lib/api/auth';
import Divider from 'antd/es/divider';
import { getLoginRedirectUrl, navigationRoutes } from "@/lib/navigation";
import { darkTheme, cardStyle } from '@/components/common/theme';
import '@/components/common/animations.css';

const { Title, Text, Paragraph } = Typography;
const { TextArea } = Input;
const { Option } = Select;

interface CreatePostPageProps {
    title: string;
    body: string;
    content: string;
}

export default function CreatePostPage() {
    const router = useRouter();
    const [form] = Form.useForm();
    const [loading, setLoading] = useState(false);
    const [content, setContent] = useState('');
    const [selectedTags, setSelectedTags] = useState<string[]>([]);
    const [previewMode, setPreviewMode] = useState(false);
    const [mounted, setMounted] = useState(false);

    useEffect(() => {
        setMounted(true);
    }, []);

    // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
    useEffect(() => {
        if (mounted && !AuthApi.isAuthenticated()) {
            message.warning('ËØ∑ÂÖàÁôªÂΩï');
            router.push(getLoginRedirectUrl(navigationRoutes.postCreate));
        }
    }, [mounted, router]);

    // Ê∏∏ÊàèÂàÜÁ±ª
    const categories = [
        { value: 'Ê∏∏ÊàèËÆ®ËÆ∫', icon: 'üí¨', color: '#6366f1' },
        { value: 'ÊîªÁï•ÂàÜ‰∫´', icon: 'üìñ', color: '#8b5cf6' },
        { value: 'Ê∏∏ÊàèËØÑÊµã', icon: '‚≠ê', color: '#06b6d4' },
        { value: 'ÂØªÊâæÈòüÂèã', icon: 'üë•', color: '#10b981' },
        { value: 'ÊäÄÊúØ‰∫§ÊµÅ', icon: '‚öôÔ∏è', color: '#f59e0b' },
        { value: 'Ê∏∏ÊàèËµÑËÆØ', icon: 'üì∞', color: '#ef4444' },
        { value: 'ÂÖ∂‰ªñ', icon: 'üì¶', color: '#6b7280' },
    ];

    // ÁÉ≠Èó®Ê†áÁ≠æ
    const popularTags = [
        'ÂéüÁ•û', 'ÁéãËÄÖËç£ËÄÄ', 'Ëã±ÈõÑËÅîÁõü', 'CS2', 'APEX',
        'Ê∞∏Âä´Êó†Èó¥', 'ÂçöÂæ∑‰πãÈó®3', 'ÈªëÁ•ûËØùÊÇüÁ©∫', 'ËâæÂ∞îÁôªÊ≥ïÁéØ',
        'Steam', 'Epic', 'Áã¨Á´ãÊ∏∏Êàè', '3AÂ§ß‰Ωú', 'RPG',
        'FPS', 'MOBA', 'ÂºÄÊîæ‰∏ñÁïå', 'ÊÅêÊÄñÊ∏∏Êàè', 'ÁîüÂ≠òÊ∏∏Êàè',
    ];

    // Êèê‰∫§Â∏ñÂ≠ê
    const handleSubmit = async (values: CreatePostPageProps) => {
        try {
            setLoading(true);

            const postData: CreatePostRequest = {
                title: values.title,
                body: content || values.content,
            };

            await PostsApi.createPost(postData);

            message.success('ÂèëÂ∏ÉÊàêÂäüÔºÅ');

            // Ë∑≥ËΩ¨Âà∞ËÆ∫ÂùõÈ¶ñÈ°µ
            setTimeout(() => {
                router.push(navigationRoutes.forum);
            }, 500);
        } catch (error: unknown) {
            if (error instanceof Error) {
                message.error(error.message || 'ÂèëÂ∏ÉÂ§±Ë¥•');
            } else {
                message.error('ÂèëÂ∏ÉÂ§±Ë¥•ÔºåËØ∑ÈáçËØï');
            }
        } finally {
            setLoading(false);
        }
    };

    // ‰øùÂ≠òËçâÁ®ø
    const handleSaveDraft = () => {
        const values = form.getFieldsValue();
        localStorage.setItem('post_draft', JSON.stringify({
            ...values,
            content,
            tags: selectedTags,
            savedAt: new Date().toISOString(),
        }));
        message.success('ËçâÁ®øÂ∑≤‰øùÂ≠ò');
    };

    // Âä†ËΩΩËçâÁ®ø
    const loadDraft = () => {
        const draft = localStorage.getItem('post_draft');
        if (draft) {
            try {
                const draftData = JSON.parse(draft);
                form.setFieldsValue(draftData);
                setContent(draftData.content || '');
                setSelectedTags(draftData.tags || []);
                message.info(`Â∑≤Âä†ËΩΩ ${new Date(draftData.savedAt).toLocaleString()} ÁöÑËçâÁ®ø`);
            } catch (error) {
                message.error('ËçâÁ®øÂä†ËΩΩÂ§±Ë¥•');
            }
        } else {
            message.info('ÊöÇÊó†ËçâÁ®ø');
        }
    };

    // Ê∏ÖÈô§ËçâÁ®ø
    const clearDraft = () => {
        localStorage.removeItem('post_draft');
        form.resetFields();
        setContent('');
        setSelectedTags([]);
        message.success('ËçâÁ®øÂ∑≤Ê∏ÖÈô§');
    };

    // ÊèíÂÖ•Ê†ºÂºèÂåñÊñáÊú¨
    const insertFormat = (format: string) => {
        const textarea = document.querySelector('textarea') as HTMLTextAreaElement;
        if (!textarea) return;

        const start = textarea.selectionStart;
        const end = textarea.selectionEnd;
        const selectedText = content.substring(start, end);
        let newText = '';

        switch (format) {
            case 'bold':
                newText = `**${selectedText || 'Á≤ó‰ΩìÊñáÊú¨'}**`;
                break;
            case 'italic':
                newText = `*${selectedText || 'Êñú‰ΩìÊñáÊú¨'}*`;
                break;
            case 'link':
                newText = `[${selectedText || 'ÈìæÊé•ÊñáÊú¨'}](URL)`;
                break;
            case 'image':
                newText = `![${selectedText || 'ÂõæÁâáÊèèËø∞'}](ÂõæÁâáURL)`;
                break;
            case 'ul':
                newText = `\n- ${selectedText || 'ÂàóË°®È°π'}\n`;
                break;
            case 'ol':
                newText = `\n1. ${selectedText || 'ÂàóË°®È°π'}\n`;
                break;
            default:
                newText = selectedText;
        }

        const newContent = content.substring(0, start) + newText + content.substring(end);
        setContent(newContent);
        form.setFieldValue('content', newContent);
    };

    // Ê†áÁ≠æÈÄâÊã©
    const handleTagSelect = (tag: string) => {
        if (selectedTags.includes(tag)) {
            setSelectedTags(selectedTags.filter(t => t !== tag));
        } else if (selectedTags.length < 5) {
            setSelectedTags([...selectedTags, tag]);
        } else {
            message.warning('ÊúÄÂ§öÂè™ËÉΩÈÄâÊã©5‰∏™Ê†áÁ≠æ');
        }
    };

    if (!mounted) {
        return null;
    }

    return (
        <ConfigProvider theme={darkTheme}>
            {/* È°∂ÈÉ®ÂØºËà™Ê†è */}
            <Menubar currentPath="/dashboard/forum/create" />
            
            <div 
                className="animate-fade-in-up"
                style={{
                    minHeight: '100vh',
                    background: `
                        radial-gradient(ellipse at top left, rgba(99, 102, 241, 0.3) 0%, transparent 50%),
                        radial-gradient(ellipse at bottom right, rgba(168, 85, 247, 0.3) 0%, transparent 50%),
                        radial-gradient(ellipse at center, rgba(59, 130, 246, 0.2) 0%, transparent 50%),
                        linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%)
                    `,
                    paddingTop: '88px',
                    paddingBottom: '40px',
                }}
            >
                <div style={{ 
                    maxWidth: 1200, 
                    margin: '0 auto', 
                    padding: '0 24px',
                }}>
                    {/* È°µÈù¢Ê†áÈ¢ò */}
                    <Card 
                        className="animate-card-hover"
                        style={{ 
                            marginBottom: 24,
                            ...cardStyle,
                        }}
                        styles={{ body: { padding: '24px' } }}
                    >
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                            <Space size="large">
                                <Button
                                    icon={<ArrowLeftOutlined />}
                                    onClick={() => router.back()}
                                    size="large"
                                    style={{
                                        background: 'rgba(31, 41, 55, 0.8)',
                                        border: '1px solid rgba(99, 102, 241, 0.3)',
                                        color: '#d1d5db',
                                        borderRadius: '12px',
                                        height: '48px',
                                        fontWeight: 600,
                                    }}
                                >
                                    ËøîÂõû
                                </Button>
                                <div>
                                    <Title 
                                        level={2} 
                                        style={{ 
                                            margin: 0,
                                            color: '#f9fafb',
                                            fontSize: '32px',
                                            fontWeight: 700,
                                            background: 'linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%)',
                                            WebkitBackgroundClip: 'text',
                                            WebkitTextFillColor: 'transparent',
                                            backgroundClip: 'text',
                                        }}
                                    >
                                        ‚úçÔ∏è ÂèëÂ∏ÉÊñ∞Â∏ñ
                                    </Title>
                                    <Text style={{ color: '#9ca3af', fontSize: '14px', display: 'block', marginTop: '4px' }}>
                                        ÂàÜ‰∫´‰Ω†ÁöÑÊ∏∏ÊàèËßÅËß£‰∏é‰ΩìÈ™å
                                    </Text>
                                </div>
                            </Space>
                        </div>
                    </Card>

                    {/* ‰∏ªË°®Âçï */}
                    <Form
                        form={form}
                        layout="vertical"
                        onFinish={handleSubmit}
                        autoComplete="off"
                    >
                        <Row gutter={24}>
                            <Col xs={24} lg={16}>
                                <Card 
                                    className="animate-card-hover"
                                    style={{
                                        marginBottom: 24,
                                        ...cardStyle,
                                    }}
                                    styles={{ body: { padding: '32px' } }}
                                >
                                    {/* Ê†áÈ¢òËæìÂÖ• */}
                                    <Form.Item
                                        label={
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                üìù Â∏ñÂ≠êÊ†áÈ¢ò
                                            </span>
                                        }
                                        name="title"
                                        rules={[
                                            { required: true, message: 'ËØ∑ËæìÂÖ•Ê†áÈ¢ò' },
                                            { min: 5, message: 'Ê†áÈ¢òËá≥Â∞ë5‰∏™Â≠óÁ¨¶' },
                                            { max: 100, message: 'Ê†áÈ¢òÊúÄÂ§ö100‰∏™Â≠óÁ¨¶' },
                                        ]}
                                    >
                                        <Input
                                            placeholder="Áªô‰Ω†ÁöÑÂ∏ñÂ≠êËµ∑‰∏™Âê∏Âºï‰∫∫ÁöÑÊ†áÈ¢òÂêß..."
                                            size="large"
                                            showCount
                                            maxLength={100}
                                            style={{
                                                height: '56px',
                                                fontSize: '16px',
                                                borderRadius: '12px',
                                                background: 'rgba(31, 41, 55, 0.5)',
                                                border: '1px solid rgba(75, 85, 99, 0.3)',
                                                color: '#f9fafb',
                                            }}
                                        />
                                    </Form.Item>

                                    {/* Markdown Â∑•ÂÖ∑Ê†è */}
                                    <div style={{ marginBottom: '12px' }}>
                                        <Space size="small" wrap>
                                            <Tooltip title="Á≤ó‰Ωì (Ctrl/Cmd + B)">
                                                <Button
                                                    type="text"
                                                    icon={<BoldOutlined />}
                                                    onClick={() => insertFormat('bold')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                            <Tooltip title="Êñú‰Ωì (Ctrl/Cmd + I)">
                                                <Button
                                                    type="text"
                                                    icon={<ItalicOutlined />}
                                                    onClick={() => insertFormat('italic')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                            <Tooltip title="ÊèíÂÖ•ÈìæÊé•">
                                                <Button
                                                    type="text"
                                                    icon={<LinkOutlined />}
                                                    onClick={() => insertFormat('link')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                            <Tooltip title="ÊèíÂÖ•ÂõæÁâá">
                                                <Button
                                                    type="text"
                                                    icon={<PictureOutlined />}
                                                    onClick={() => insertFormat('image')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                            <Tooltip title="Êó†Â∫èÂàóË°®">
                                                <Button
                                                    type="text"
                                                    icon={<UnorderedListOutlined />}
                                                    onClick={() => insertFormat('ul')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                            <Tooltip title="ÊúâÂ∫èÂàóË°®">
                                                <Button
                                                    type="text"
                                                    icon={<OrderedListOutlined />}
                                                    onClick={() => insertFormat('ol')}
                                                    style={{
                                                        color: '#9ca3af',
                                                        borderRadius: '8px',
                                                        background: 'rgba(31, 41, 55, 0.5)',
                                                    }}
                                                />
                                            </Tooltip>
                                        </Space>
                                    </div>

                                    {/* ÂÜÖÂÆπËæìÂÖ• */}
                                    <Form.Item
                                        label={
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                üìÑ Â∏ñÂ≠êÂÜÖÂÆπ
                                            </span>
                                        }
                                        name="content"
                                        rules={[
                                            { required: true, message: 'ËØ∑ËæìÂÖ•ÂÜÖÂÆπ' },
                                            { min: 20, message: 'ÂÜÖÂÆπËá≥Â∞ë20‰∏™Â≠óÁ¨¶' },
                                        ]}
                                    >
                                        <TextArea
                                            value={content}
                                            onChange={(e) => setContent(e.target.value)}
                                            placeholder="ÂàÜ‰∫´‰Ω†ÁöÑÊ∏∏Êàè‰ΩìÈ™å„ÄÅÊîªÁï•ÂøÉÂæó„ÄÅËØÑÊµãÊÉ≥Ê≥ï... ÊîØÊåÅ Markdown Ê†ºÂºè"
                                            rows={16}
                                            showCount
                                            maxLength={10000}
                                            style={{
                                                fontSize: '15px',
                                                borderRadius: '12px',
                                                background: 'rgba(31, 41, 55, 0.5)',
                                                border: '1px solid rgba(75, 85, 99, 0.3)',
                                                color: '#f9fafb',
                                                lineHeight: 1.6,
                                            }}
                                        />
                                    </Form.Item>

                                    {/* ÂõæÁâá‰∏ä‰º† */}
                                    <Form.Item 
                                        label={
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                üñºÔ∏è ‰∏ä‰º†ÂõæÁâá (ÂèØÈÄâ)
                                            </span>
                                        }
                                    >
                                        <Upload
                                            listType="picture-card"
                                            maxCount={9}
                                            beforeUpload={() => false}
                                            style={{
                                                background: 'rgba(31, 41, 55, 0.5)',
                                            }}
                                        >
                                            <div style={{ color: '#9ca3af' }}>
                                                <UploadOutlined style={{ fontSize: '24px' }} />
                                                <div style={{ marginTop: 8 }}>‰∏ä‰º†ÂõæÁâá</div>
                                            </div>
                                        </Upload>
                                        <Text type="secondary" style={{ color: '#9ca3af', fontSize: '13px' }}>
                                            ÊúÄÂ§ö‰∏ä‰º†9Âº†ÂõæÁâáÔºåÂçïÂº†‰∏çË∂ÖËøá5MB
                                        </Text>
                                    </Form.Item>
                                </Card>
                            </Col>

                            <Col xs={24} lg={8}>
                                {/* ÂàÜÁ±ªÈÄâÊã© */}
                                <Card 
                                    className="animate-card-hover"
                                    style={{ 
                                        marginBottom: 20,
                                        ...cardStyle,
                                    }}
                                    styles={{ body: { padding: '24px' } }}
                                >
                                    <Form.Item
                                        label={
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                üè∑Ô∏è Â∏ñÂ≠êÂàÜÁ±ª
                                            </span>
                                        }
                                        name="category"
                                        rules={[{ required: true, message: 'ËØ∑ÈÄâÊã©ÂàÜÁ±ª' }]}
                                    >
                                        <Select 
                                            placeholder="ÈÄâÊã©‰∏Ä‰∏™ÂàÜÁ±ª" 
                                            size="large"
                                            style={{
                                                borderRadius: '12px',
                                            }}
                                        >
                                            {categories.map(cat => (
                                                <Option key={cat.value} value={cat.value}>
                                                    <Space>
                                                        <span style={{ fontSize: '18px' }}>{cat.icon}</span>
                                                        <span>{cat.value}</span>
                                                    </Space>
                                                </Option>
                                            ))}
                                        </Select>
                                    </Form.Item>

                                    {/* Ê†áÁ≠æÈÄâÊã© */}
                                    <Form.Item 
                                        label={
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                üîñ Ê∑ªÂä†Ê†áÁ≠æ
                                            </span>
                                        }
                                    >
                                        <div style={{ marginBottom: 12 }}>
                                            <Text style={{ color: '#9ca3af', fontSize: '13px' }}>
                                                Â∑≤ÈÄâÊã© {selectedTags.length}/5 ‰∏™Ê†áÁ≠æ
                                            </Text>
                                        </div>
                                        {selectedTags.length > 0 && (
                                            <Space wrap style={{ marginBottom: 12 }}>
                                                {selectedTags.map(tag => (
                                                    <Tag
                                                        key={tag}
                                                        closable
                                                        onClose={() => handleTagSelect(tag)}
                                                        style={{
                                                            background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',
                                                            border: 'none',
                                                            color: '#fff',
                                                            padding: '4px 12px',
                                                            borderRadius: '8px',
                                                            fontSize: '13px',
                                                        }}
                                                    >
                                                        {tag}
                                                    </Tag>
                                                ))}
                                            </Space>
                                        )}
                                        <div>
                                            <Text type="secondary" style={{ color: '#9ca3af', fontSize: '13px' }}>
                                                ÁÉ≠Èó®Ê†áÁ≠æÔºö
                                            </Text>
                                            <div style={{ marginTop: 8 }}>
                                                <Space wrap size={[8, 8]}>
                                                    {popularTags.map(tag => (
                                                        <Tag
                                                            key={tag}
                                                            style={{ 
                                                                cursor: 'pointer',
                                                                background: selectedTags.includes(tag) 
                                                                    ? 'rgba(99, 102, 241, 0.2)'
                                                                    : 'rgba(31, 41, 55, 0.5)',
                                                                border: selectedTags.includes(tag)
                                                                    ? '1px solid rgba(99, 102, 241, 0.5)'
                                                                    : '1px solid rgba(75, 85, 99, 0.3)',
                                                                color: selectedTags.includes(tag) ? '#818cf8' : '#9ca3af',
                                                                borderRadius: '8px',
                                                                padding: '4px 10px',
                                                                fontSize: '12px',
                                                                transition: 'all 0.3s ease',
                                                            }}
                                                            onClick={() => handleTagSelect(tag)}
                                                        >
                                                            {tag}
                                                        </Tag>
                                                    ))}
                                                </Space>
                                            </div>
                                        </div>
                                    </Form.Item>
                                </Card>

                                {/* Êìç‰ΩúÊåâÈíÆ */}
                                <Card 
                                    className="animate-card-hover"
                                    style={{ 
                                        marginBottom: 20,
                                        ...cardStyle,
                                    }}
                                    styles={{ body: { padding: '24px' } }}
                                >
                                    <Space direction="vertical" style={{ width: '100%' }} size="middle">
                                        <Button
                                            type="primary"
                                            htmlType="submit"
                                            block
                                            size="large"
                                            loading={loading}
                                            icon={<SendOutlined />}
                                            style={{
                                                height: '56px',
                                                fontSize: '18px',
                                                fontWeight: 600,
                                                background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #06b6d4 100%)',
                                                border: 'none',
                                                borderRadius: '12px',
                                                boxShadow: '0 8px 32px rgba(99, 102, 241, 0.3)',
                                                transition: 'all 0.3s ease',
                                            }}
                                            onMouseEnter={(e) => {
                                                e.currentTarget.style.transform = 'translateY(-2px)';
                                                e.currentTarget.style.boxShadow = '0 12px 40px rgba(99, 102, 241, 0.4)';
                                            }}
                                            onMouseLeave={(e) => {
                                                e.currentTarget.style.transform = 'translateY(0)';
                                                e.currentTarget.style.boxShadow = '0 8px 32px rgba(99, 102, 241, 0.3)';
                                            }}
                                        >
                                            ÂèëÂ∏ÉÂ∏ñÂ≠ê
                                        </Button>

                                        <Button
                                            block
                                            size="large"
                                            icon={<SaveOutlined />}
                                            onClick={handleSaveDraft}
                                            style={{
                                                height: '48px',
                                                borderRadius: '12px',
                                                background: 'rgba(31, 41, 55, 0.8)',
                                                border: '1px solid rgba(99, 102, 241, 0.3)',
                                                color: '#d1d5db',
                                                fontWeight: 600,
                                            }}
                                        >
                                            ‰øùÂ≠òËçâÁ®ø
                                        </Button>

                                        <Button
                                            block
                                            size="large"
                                            icon={previewMode ? <EditOutlined /> : <EyeOutlined />}
                                            onClick={() => setPreviewMode(!previewMode)}
                                            style={{
                                                height: '48px',
                                                borderRadius: '12px',
                                                background: 'rgba(31, 41, 55, 0.8)',
                                                border: '1px solid rgba(99, 102, 241, 0.3)',
                                                color: '#d1d5db',
                                                fontWeight: 600,
                                            }}
                                        >
                                            {previewMode ? 'ÁºñËæëÊ®°Âºè' : 'È¢ÑËßàÊ®°Âºè'}
                                        </Button>

                                        <Divider style={{ margin: '12px 0', borderColor: 'rgba(99, 102, 241, 0.2)' }} />

                                        <Space style={{ width: '100%', justifyContent: 'space-between' }}>
                                            <Button 
                                                type="link" 
                                                icon={<ReloadOutlined />}
                                                onClick={loadDraft}
                                                style={{ 
                                                    color: '#818cf8',
                                                    fontWeight: 500,
                                                }}
                                            >
                                                Âä†ËΩΩËçâÁ®ø
                                            </Button>
                                            <Button 
                                                type="link" 
                                                danger 
                                                icon={<DeleteOutlined />}
                                                onClick={clearDraft}
                                                style={{ 
                                                    fontWeight: 500,
                                                }}
                                            >
                                                Ê∏ÖÈô§ËçâÁ®ø
                                            </Button>
                                        </Space>
                                    </Space>
                                </Card>

                                {/* ÂèëÂ∏ñÈ°ªÁü• */}
                                <Card 
                                    className="animate-card-hover"
                                    title={
                                        <Space>
                                            <InfoCircleOutlined style={{ color: '#06b6d4' }} />
                                            <span style={{ color: '#f9fafb', fontSize: '16px', fontWeight: 600 }}>
                                                ÂèëÂ∏ñÈ°ªÁü•
                                            </span>
                                        </Space>
                                    }
                                    style={cardStyle}
                                    styles={{ body: { padding: '20px' } }}
                                >
                                    <div style={{ color: '#9ca3af', fontSize: '13px', lineHeight: 2 }}>
                                        <p style={{ margin: '8px 0', display: 'flex', alignItems: 'flex-start' }}>
                                            <span style={{ color: '#6366f1', marginRight: '8px' }}>‚Ä¢</span>
                                            <span>ËØ∑ÈÅµÂÆàÁ§æÂå∫ËßÑËåÉÔºåÊñáÊòéÂèãÂñÑ‰∫§ÊµÅ</span>
                                        </p>
                                        <p style={{ margin: '8px 0', display: 'flex', alignItems: 'flex-start' }}>
                                            <span style={{ color: '#6366f1', marginRight: '8px' }}>‚Ä¢</span>
                                            <span>‰∏çÂæóÂèëÂ∏ÉËøùÊ≥ïËøùËßÑÊàñ‰∏çËâØÂÜÖÂÆπ</span>
                                        </p>
                                        <p style={{ margin: '8px 0', display: 'flex', alignItems: 'flex-start' }}>
                                            <span style={{ color: '#6366f1', marginRight: '8px' }}>‚Ä¢</span>
                                            <span>Á¶ÅÊ≠¢ÊÅ∂ÊÑèÂà∑Â±è„ÄÅÂπøÂëäÂèäÂûÉÂúæ‰ø°ÊÅØ</span>
                                        </p>
                                        <p style={{ margin: '8px 0', display: 'flex', alignItems: 'flex-start' }}>
                                            <span style={{ color: '#6366f1', marginRight: '8px' }}>‚Ä¢</span>
                                            <span>ËΩ¨ËΩΩÂÜÖÂÆπËØ∑Ê≥®ÊòéÂéü‰ΩúËÄÖÂíåÂá∫Â§Ñ</span>
                                        </p>
                                        <p style={{ margin: '8px 0', display: 'flex', alignItems: 'flex-start' }}>
                                            <span style={{ color: '#6366f1', marginRight: '8px' }}>‚Ä¢</span>
                                            <span>ÂÜÖÂÆπÊîØÊåÅ Markdown Ê†ºÂºèÊéíÁâà</span>
                                        </p>
                                    </div>
                                </Card>
                            </Col>
                        </Row>
                    </Form>

                    {/* È¢ÑËßàÊ®°Âºè */}
                    {previewMode && (
                        <Card 
                            className="animate-fade-in-up"
                            style={{ 
                                marginTop: 24,
                                ...cardStyle,
                            }}
                            styles={{ body: { padding: '40px' } }}
                        >
                            <Space direction="vertical" style={{ width: '100%' }} size="large">
                                <div style={{ 
                                    display: 'flex', 
                                    alignItems: 'center', 
                                    gap: '12px',
                                    paddingBottom: '20px',
                                    borderBottom: '1px solid rgba(99, 102, 241, 0.2)',
                                }}>
                                    <EyeOutlined style={{ fontSize: '24px', color: '#6366f1' }} />
                                    <Title level={3} style={{ margin: 0, color: '#f9fafb' }}>
                                        ÂÜÖÂÆπÈ¢ÑËßà
                                    </Title>
                                </div>
                                
                                <Title 
                                    level={2} 
                                    style={{ 
                                        margin: 0,
                                        color: '#f9fafb',
                                        fontSize: '28px',
                                        fontWeight: 600,
                                    }}
                                >
                                    {form.getFieldValue('title') || 'Ê†áÈ¢òÈ¢ÑËßà'}
                                </Title>
                                
                                <div style={{
                                    color: '#d1d5db',
                                    fontSize: '15px',
                                    lineHeight: 1.8,
                                    whiteSpace: 'pre-wrap',
                                    wordBreak: 'break-word',
                                }}>
                                    {content || 'ÂÜÖÂÆπÈ¢ÑËßà...'}
                                </div>

                                {selectedTags.length > 0 && (
                                    <div>
                                        <Divider style={{ margin: '20px 0', borderColor: 'rgba(99, 102, 241, 0.2)' }} />
                                        <Space wrap>
                                            {selectedTags.map(tag => (
                                                <Tag
                                                    key={tag}
                                                    style={{
                                                        background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',
                                                        border: 'none',
                                                        color: '#fff',
                                                        padding: '4px 12px',
                                                        borderRadius: '8px',
                                                        fontSize: '13px',
                                                    }}
                                                >
                                                    {tag}
                                                </Tag>
                                            ))}
                                        </Space>
                                    </div>
                                )}
                            </Space>
                        </Card>
                    )}
                </div>
            </div>
        </ConfigProvider>
    );
}
